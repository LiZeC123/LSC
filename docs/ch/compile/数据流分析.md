
中间代码优化的基础是数据流分析，即根据中间代码的跳转逻辑分析代码的执行顺序，从而后续的奠定基础。



### 首指令

首指令是每个基本块的第一条指令。基本块内不存在任何跳转指令，其中的代码全部都是顺序执行。通过对首指令的分析，可以将一段代码分割为若干个逻辑块。

根据上述目标，可以发现如下的一些质量是首指令：
1. 每个代码片段的第一条指令
2. 跳转指令的目标指令
3. 跳转指令之后的下一条指令

注意： 函数调用虽然也跳转了，但这种操作在函数执行完毕后实际上是不可感知的（即无法知道是执行了一个函数还是一个简单的复制操作），因此不影响数据流动分析。



数据流分析框架
-------------------

数据流分析框架是一组标准的分析流程，将不同的操作带入数据流分析框架中可以实现不同的分析效果，从而实现常量传播，复写传播等功能。

数据流分析框架定义了一个四元组(D,V,Λ,F)，其中D表示数据的流向，分为正向和逆向; V表示数据流框架中统计的值的集合; Λ表示交汇函数，用于将多个V中的值合并为一个值; F表示基本块传递函数，规定了数据流信息经过基本块的计算规则。

例如，对于分析函数最少执行的代码行数的问题，可以定义
- D 正向流动
- V 自然数集合，表示代码的行数
- Λ in = min(p.out)，只考虑代码行数最少的前驱块传递的信息
- F out = in + num，前驱块的代码行数加上当前块的代码行数即为总代码行数



### 常量传播分析

由于常量传播需要按照代码的执行顺序进行分析，因此D为正向流动。V取值为整数集合与两个特殊符号的并集，其中UNDEF表示变量暂时无法确定是否为常量，NAC表示变量确定不是常量。

Λ的定义如下：
1. 对于任意值v，有UNDEF Λ v = v， NAC Λ v = NAC
2. 对于常量值c，有c Λ c = c
3. 对于不同的常量值c1和c2，有c1 Λ c2 = NAC

使用Λ操作即可分析不同执行路径下的变量是否是常量，


